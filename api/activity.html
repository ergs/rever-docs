


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Activity Base Class (rever.acctivity) &#8212; rever 0.2.7 documentation</title>
    <link rel="stylesheet" href="../_static/numpy_friendly.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="../_static/cloud.base.js"></script>
    <script type="text/javascript" src="../_static/cloud.js"></script>
    <link rel="shortcut icon" href="../_static/longship.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Directed Acyclic Graph Tools (rever.dag)" href="dag.html" />
    <link rel="prev" title="Version Bump Activity (rever.activities.version_bump)" href="activities/version_bump.html" />
     
        <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="canonical" href="http://xon.sh/api/activity.html"/>

  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="dag.html" title="Directed Acyclic Graph Tools (rever.dag)"
             accesskey="N">next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="activities/version_bump.html" title="Version Bump Activity (rever.activities.version_bump)"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">rever 0.2.7 documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Rever API</a> &#187;</li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-rever.activity">
<span id="activity-base-class-rever-acctivity"></span><span id="rever-activity"></span><h1>Activity Base Class (<code class="docutils literal notranslate"><span class="pre">rever.acctivity</span></code>)<a class="headerlink" href="#module-rever.activity" title="Permalink to this headline">¶</a></h1>
<p>Provides basic activity funtionality.</p>
<dl class="class">
<dt id="rever.activity.Activity">
<em class="property">class </em><code class="descclassname">rever.activity.</code><code class="descname">Activity</code><span class="sig-paren">(</span><em>*</em>, <em>name=None</em>, <em>deps=frozenset()</em>, <em>func=None</em>, <em>undo=None</em>, <em>setup=None</em>, <em>args=None</em>, <em>kwargs=None</em>, <em>desc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#rever.activity.Activity" title="Permalink to this definition">¶</a></dt>
<dd><p>Activity representing a node in DAG of release tasks.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd><p class="first last">Name of the activity.</p>
</dd>
<dt><strong>deps</strong> <span class="classifier-delimiter">:</span> <span class="classifier">set of str, optional</span></dt>
<dd><p class="first last">Set of activities that must be completed before this activity is
executed.</p>
</dd>
<dt><strong>func</strong> <span class="classifier-delimiter">:</span> <span class="classifier">callable, optional</span></dt>
<dd><p class="first last">Function to perform as activity when this activities is executed (called).</p>
</dd>
<dt><strong>undo</strong> <span class="classifier-delimiter">:</span> <span class="classifier">callable, optional</span></dt>
<dd><p class="first last">Function to undo this activities behaviour and reset the repo state.</p>
</dd>
<dt><strong>setup</strong> <span class="classifier-delimiter">:</span> <span class="classifier">callable, optional</span></dt>
<dd><p class="first last">Function to help initialize the activity.</p>
</dd>
<dt><strong>args</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple, optional</span></dt>
<dd><p class="first last">Arguments to be supplied to the <code class="docutils literal notranslate"><span class="pre">func(*args)</span></code>, if needed.</p>
</dd>
<dt><strong>kwargs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">mapping, optional</span></dt>
<dd><p class="first last">Keyword arguments to be supplied to the <code class="docutils literal notranslate"><span class="pre">func(**kwargs)</span></code>, if needed.</p>
</dd>
<dt><strong>desc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd><p class="first last">A short description of this activity</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="rever.activity.Activity.all_kwargs">
<code class="descname">all_kwargs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rever.activity.Activity.all_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all kwargs for this activity.</p>
</dd></dl>

<dl class="method">
<dt id="rever.activity.Activity.clear_kwargs_from_env">
<code class="descname">clear_kwargs_from_env</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rever.activity.Activity.clear_kwargs_from_env" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes kwarg from the environment, if they exist.</p>
</dd></dl>

<dl class="method">
<dt id="rever.activity.Activity.kwargs_from_env">
<code class="descname">kwargs_from_env</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rever.activity.Activity.kwargs_from_env" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtains possible func() kwarg from the environment.</p>
</dd></dl>

<dl class="method">
<dt id="rever.activity.Activity.setup">
<code class="descname">setup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rever.activity.Activity.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls this activities setup() initialization function.</p>
</dd></dl>

<dl class="method">
<dt id="rever.activity.Activity.setupper">
<code class="descname">setupper</code><span class="sig-paren">(</span><em>setup</em><span class="sig-paren">)</span><a class="headerlink" href="#rever.activity.Activity.setupper" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator that sets the setup function for this activity.</p>
</dd></dl>

<dl class="method">
<dt id="rever.activity.Activity.undo">
<code class="descname">undo</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rever.activity.Activity.undo" title="Permalink to this definition">¶</a></dt>
<dd><p>Reverts to the last instance of this activity. This default implementation
uses the revision in the log file from the last time that the activity was
started. This may be overridden in a subclass.</p>
</dd></dl>

<dl class="method">
<dt id="rever.activity.Activity.undoer">
<code class="descname">undoer</code><span class="sig-paren">(</span><em>undo</em><span class="sig-paren">)</span><a class="headerlink" href="#rever.activity.Activity.undoer" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator that sets the undo function for this activity.</p>
</dd></dl>

<dl class="attribute">
<dt id="rever.activity.Activity.env_names">
<code class="descname">env_names</code><a class="headerlink" href="#rever.activity.Activity.env_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping parameter names to the names of environment
varaibles that the activity looks for when it is executed.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="rever.activity.DockerActivity">
<em class="property">class </em><code class="descclassname">rever.activity.</code><code class="descname">DockerActivity</code><span class="sig-paren">(</span><em>*</em>, <em>name=None</em>, <em>deps=frozenset()</em>, <em>func=None</em>, <em>undo=None</em>, <em>desc=None</em>, <em>image=None</em>, <em>lang='xonsh'</em>, <em>run_args=('-c'</em>, <em>)</em>, <em>code=None</em>, <em>env=True</em>, <em>mounts=()</em><span class="sig-paren">)</span><a class="headerlink" href="#rever.activity.DockerActivity" title="Permalink to this definition">¶</a></dt>
<dd><p>An activity that executes within a docker container.</p>
<p>A Docker activity, by default will respect the following environment
variables, if they are set:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">$&lt;NAME&gt;_IMAGE:</th><td class="field-body">str, Name of the image to run, defaults to
$DOCKER_INSTALL_IMAGE. Environment variables will be expanded when
the activity is run.</td>
</tr>
<tr class="field-even field"><th class="field-name">$&lt;NAME&gt;_LANG:</th><td class="field-body">str, Language to execute the body in, default xonsh.
This may also be a full path to an executable.</td>
</tr>
<tr class="field-odd field"><th class="field-name">$&lt;NAME&gt;_ARGS:</th><td class="field-body">sequence of str, Extra arguments to pass in after
the executable but before the main body. Defaults to the standard
compile flag <code class="docutils literal notranslate"><span class="pre">'-c'</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">$&lt;NAME&gt;_ENV:</th><td class="field-body">bool or dict, Environment to use. This has the same meaning as in
<code class="docutils literal notranslate"><span class="pre">rever.docker.run_in_container()</span></code>. Please see that function for
more details, default True.</td>
</tr>
<tr class="field-odd field"><th class="field-name">$&lt;NAME&gt;_MOUNT:</th><td class="field-body">list of dict, Locations to mount in the running container.
This has the same meaning as in <code class="docutils literal notranslate"><span class="pre">rever.docker.run_in_container()</span></code>.
Please see that function for more details, default does not mount anything.</td>
</tr>
</tbody>
</table>
<p>Additionally, DockerActivities are macro context managers. This allows you
to set the code block by entering the context:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>with! DockerActivity(name=&#39;myactivity&#39;):
    echo &quot;I will be run in the docker container!&quot;
</pre></div>
</div>
<p>Entering the context manager will also automatically register the
activity in the DAG.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>name</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd><p class="first last">Name of the activity.</p>
</dd>
<dt><strong>deps</strong> <span class="classifier-delimiter">:</span> <span class="classifier">set of str, optional</span></dt>
<dd><p class="first last">Set of activities that must be completed before this activity is
executed.</p>
</dd>
<dt><strong>func</strong> <span class="classifier-delimiter">:</span> <span class="classifier">callable, optional</span></dt>
<dd><p class="first last">Function to perform as activity when this activities is executed
(called).  The default _func method is good enough for most cases.</p>
</dd>
<dt><strong>undo</strong> <span class="classifier-delimiter">:</span> <span class="classifier">callable, optional</span></dt>
<dd><p class="first last">Function to undo this activities behaviour and reset the repo state.</p>
</dd>
<dt><strong>desc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd><p class="first last">A short description of this activity</p>
</dd>
<dt><strong>image</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str or None, optional</span></dt>
<dd><p class="first last">Name of the image to run, defaults to $DOCKER_INSTALL_IMAGE.
Environment variables will be expanded when the activity is run.</p>
</dd>
<dt><strong>lang</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd><p class="first last">Language to execute the body in, default xonsh. This may also be a full
path to an executable.</p>
</dd>
<dt><strong>run_args</strong> <span class="classifier-delimiter">:</span> <span class="classifier">sequence of str, optional</span></dt>
<dd><p class="first last">Extra arguments to pass in after the executable but before the
main body. Defaults to the standard compile flag <code class="docutils literal notranslate"><span class="pre">'-c'</span></code>.</p>
</dd>
<dt><strong>code</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str or None, optional</span></dt>
<dd><p class="first last">The code to execute in the docker container with lang. If this is
None, it may be on the instance itself, passed in when the activity
is called, or set by entering the activity as a macro context manager.
In this last case, the context block is set as the code.</p>
</dd>
<dt><strong>env</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool or dict, optional</span></dt>
<dd><p class="first last">Environment to use. This has the same meaning as in
<code class="docutils literal notranslate"><span class="pre">rever.docker.run_in_container()</span></code>. Please see that function for
more details, default True.</p>
</dd>
<dt><strong>mounts</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of dict, optional</span></dt>
<dd><p class="first last">Locations to mount in the running container. This has the same meaning as
ing <code class="docutils literal notranslate"><span class="pre">run_in_container()</span></code>. Please see that function for more details, default
does not mount anything.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="rever.activity.DockerActivity.all_kwargs">
<code class="descname">all_kwargs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rever.activity.DockerActivity.all_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all kwargs for this activity.</p>
</dd></dl>

<dl class="method">
<dt id="rever.activity.DockerActivity.clear_kwargs_from_env">
<code class="descname">clear_kwargs_from_env</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rever.activity.DockerActivity.clear_kwargs_from_env" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes kwarg from the environment, if they exist.</p>
</dd></dl>

<dl class="method">
<dt id="rever.activity.DockerActivity.kwargs_from_env">
<code class="descname">kwargs_from_env</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rever.activity.DockerActivity.kwargs_from_env" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtains possible func() kwarg from the environment.</p>
</dd></dl>

<dl class="method">
<dt id="rever.activity.DockerActivity.setup">
<code class="descname">setup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rever.activity.DockerActivity.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls this activities setup() initialization function.</p>
</dd></dl>

<dl class="method">
<dt id="rever.activity.DockerActivity.setupper">
<code class="descname">setupper</code><span class="sig-paren">(</span><em>setup</em><span class="sig-paren">)</span><a class="headerlink" href="#rever.activity.DockerActivity.setupper" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator that sets the setup function for this activity.</p>
</dd></dl>

<dl class="method">
<dt id="rever.activity.DockerActivity.undo">
<code class="descname">undo</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#rever.activity.DockerActivity.undo" title="Permalink to this definition">¶</a></dt>
<dd><p>Reverts to the last instance of this activity. This default implementation
uses the revision in the log file from the last time that the activity was
started. This may be overridden in a subclass.</p>
</dd></dl>

<dl class="method">
<dt id="rever.activity.DockerActivity.undoer">
<code class="descname">undoer</code><span class="sig-paren">(</span><em>undo</em><span class="sig-paren">)</span><a class="headerlink" href="#rever.activity.DockerActivity.undoer" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator that sets the undo function for this activity.</p>
</dd></dl>

<dl class="attribute">
<dt id="rever.activity.DockerActivity.code">
<code class="descname">code</code><a class="headerlink" href="#rever.activity.DockerActivity.code" title="Permalink to this definition">¶</a></dt>
<dd><p>Get’s the code to execute in the docker container.</p>
</dd></dl>

<dl class="attribute">
<dt id="rever.activity.DockerActivity.env_names">
<code class="descname">env_names</code><a class="headerlink" href="#rever.activity.DockerActivity.env_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary mapping parameter names to the names of environment
varaibles that the activity looks for when it is executed.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="rever.activity.activity">
<code class="descclassname">rever.activity.</code><code class="descname">activity</code><span class="sig-paren">(</span><em>name=None</em>, <em>deps=frozenset()</em>, <em>undo=None</em>, <em>desc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#rever.activity.activity" title="Permalink to this definition">¶</a></dt>
<dd><p>A decorator that turns the function into an activity. The arguments here have the
same meaning as they do in the Activity class constructor. This decorator also
registers the activity in the $DAG.</p>
</dd></dl>

<dl class="function">
<dt id="rever.activity.dockeractivity">
<code class="descclassname">rever.activity.</code><code class="descname">dockeractivity</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#rever.activity.dockeractivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new docker activity. This accepts the same keyword arguments
as the DockerActivity class.</p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="../index.html" title="index">
          <img class="logo" src="../_static/longship-256.png" alt="Logo"/>
        </a></p>
  <div class="sphinxprev">
    <h4>Previous page</h4>
    <p class="topless"><a href="activities/version_bump.html"
                          title="Previous page">&larr; Version Bump Activity (<code class="docutils literal notranslate"><span class="pre">rever.activities.version_bump</span></code>)</a></p>
  </div>
  <div class="sphinxnext">
    <h4>Next page</h4>
    <p class="topless"><a href="dag.html"
                          title="Next page">&rarr; Directed Acyclic Graph Tools (<code class="docutils literal notranslate"><span class="pre">rever.dag</span></code>)</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/api/activity.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="dag.html" title="Directed Acyclic Graph Tools (rever.dag)"
             >next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="activities/version_bump.html" title="Version Bump Activity (rever.activities.version_bump)"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">rever 0.2.7 documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="index.html" >Rever API</a> &#187;</li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Anthony Scopatz.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.2.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>